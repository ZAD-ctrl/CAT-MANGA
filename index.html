<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>CAT-MANGA | الرئيسية</title>
    <style>
        /* تنسيق بسيط للعرض */
        body { font-family: Tahoma, sans-serif; text-align: right; margin: 50px; background-color: #161b22; color: #c9d1d9; }
        h1 { color: #58a6ff; }
        a { color: #4384e5; text-decoration: none; }
        .manga-card { border: 1px solid #30363d; padding: 15px; margin-bottom: 10px; border-radius: 6px; }
    </style>
</head>
<body>
    <h1>أحدث المانهوا المترجمة</h1>
    <div id="manga-list">
        <p>جاري تحميل قائمة المانهوا...</p>
    </div>

    <p style="margin-top: 50px;"><a href="./admin.html">لوحة تحكم الرفع</a></p>
</body>
</html>
document.addEventListener('DOMContentLoaded', loadMangaList);

async function loadMangaList() {
    const listContainer = document.getElementById('manga-list');
    listContainer.innerHTML = ''; // إزالة رسالة "جاري تحميل قائمة المانهوا..."

    try {
        // جلب ملف قاعدة البيانات
        const response = await fetch('./data/manga_list.json');
        if (!response.ok) {
            listContainer.innerHTML = '<p style="color: red;">فشل في تحميل قاعدة بيانات المانهوا.</p>';
            return;
        }

        const data = await response.json();
        
        if (data.manga.length === 0) {
            listContainer.innerHTML = '<p>لا توجد مانهوا منشورة بعد. يرجى البدء بالرفع من لوحة التحكم.</p>';
            return;
        }

        // عرض كل مانهوا
        data.manga.forEach(manga => {
            const chapterCount = manga.chapters.length;
            const card = document.createElement('div');
            card.className = 'manga-card';
            
            card.innerHTML = `
                <h2>${manga.title}</h2>
                <p>عدد الفصول: ${chapterCount} - آخر فصل: ${manga.chapters[chapterCount - 1].title}</p>
                <p>${manga.description}</p>
                `;
            listContainer.appendChild(card);
        });

    } catch (error) {
        listContainer.innerHTML = '<p style="color: red;">حدث خطأ أثناء معالجة البيانات.</p>';
        console.error('Error loading manga list:', error);
    }
}
